username = 'ps_training'
password = 'celab123'
serial = '222'
target = '192.168.1.2'

# InternetGatewayDevice

# InternetGatewayDevice.LANDeviceNumberOfEntries
# InternetGatewayDevice.WANDeviceNumberOfEntries

# InternetGatewayDevice.DeviceInfo.
# InternetGatewayDevice.DeviceInfo.Manufacturer
# InternetGatewayDevice.DeviceInfo.ProductClass
# InternetGatewayDevice.DeviceInfo.ManufacturerOUI
# InternetGatewayDevice.DeviceInfo.ModelName
# InternetGatewayDevice.DeviceInfo.Description
# InternetGatewayDevice.DeviceInfo.SerialNumber
# InternetGatewayDevice.DeviceInfo.HardwareVersion
# InternetGatewayDevice.DeviceInfo.SoftwareVersion
# InternetGatewayDevice.DeviceInfo.SpecVersion
# InternetGatewayDevice.DeviceInfo.ProvisioningCode
# InternetGatewayDevice.DeviceInfo.UpTime
# InternetGatewayDevice.DeviceInfo.FirstUseDate
# InternetGatewayDevice.DeviceInfo.DeviceLog
# InternetGatewayDevice.DeviceInfo.VendorConfigFileNumberOfEntries
# InternetGatewayDevice.DeviceInfo.VendorConfigFile.{i}.
# InternetGatewayDevice.DeviceInfo.VendorConfigFile.{i}.Name
# InternetGatewayDevice.DeviceInfo.VendorConfigFile.{i}.Version
# InternetGatewayDevice.DeviceInfo.VendorConfigFile.{i}.Date
# InternetGatewayDevice.DeviceInfo.VendorConfigFile.{i}.Description

# InternetGatewayDevice.DeviceConfig.
# InternetGatewayDevice.DeviceConfig.PersistentData
# InternetGatewayDevice.DeviceConfig.ConfigFile

# InternetGatewayDevice.ManagementServer.
# InternetGatewayDevice.ManagementServer.URL
# InternetGatewayDevice.ManagementServer.Username
# InternetGatewayDevice.ManagementServer.Password
# InternetGatewayDevice.ManagementServer.PeriodicInformEnable
# InternetGatewayDevice.ManagementServer.PeriodicInformInterval
# InternetGatewayDevice.ManagementServer.PeriodicInformTime
# InternetGatewayDevice.ManagementServer.ParameterKey
# InternetGatewayDevice.ManagementServer.ConnectionRequestURL
# InternetGatewayDevice.ManagementServer.ConnectionRequestUsername
# InternetGatewayDevice.ManagementServer.ConnectionRequestPassword
# InternetGatewayDevice.ManagementServer.UpgradesManaged

# InternetGatewayDevice.Time.
# InternetGatewayDevice.Time.NTPServer1
# InternetGatewayDevice.Time.NTPServer2
# InternetGatewayDevice.Time.NTPServer3
# InternetGatewayDevice.Time.CurrentLocalTime
# InternetGatewayDevice.Time.LocalTimeZone
# InternetGatewayDevice.Time.LocalTimeZoneName
# InternetGatewayDevice.Time.DaylightSavingsUsed
# InternetGatewayDevice.Time.DaylightSavingsStart
# InternetGatewayDevice.Time.DaylightSavingsEnd

# InternetGatewayDevice.UserInterface.
# InternetGatewayDevice.UserInterface.PasswordRequired

# InternetGatewayDevice.Layer3Forwarding.
# InternetGatewayDevice.Layer3Forwarding.DefaultConnectionService
# InternetGatewayDevice.Layer3Forwarding.ForwardNumberOfEntries
# InternetGatewayDevice.Layer3Forwarding.Forwarding.{i}.
# InternetGatewayDevice.Layer3Forwarding.Forwarding.{i}.Enable
# InternetGatewayDevice.Layer3Forwarding.Forwarding.{i}.Status
# InternetGatewayDevice.Layer3Forwarding.Forwarding.{i}.Type
# InternetGatewayDevice.Layer3Forwarding.Forwarding.{i}.DestIPAddress
# InternetGatewayDevice.Layer3Forwarding.Forwarding.{i}.DestSubnetMask
# InternetGatewayDevice.Layer3Forwarding.Forwarding.{i}.SourceIPAddress
# InternetGatewayDevice.Layer3Forwarding.Forwarding.{i}.SourceSubnetMask
# InternetGatewayDevice.Layer3Forwarding.Forwarding.{i}.GatewayIPAddress
# InternetGatewayDevice.Layer3Forwarding.Forwarding.{i}.Interface
# InternetGatewayDevice.Layer3Forwarding.Forwarding.{i}.ForwardingMetric
# InternetGatewayDevice.Layer3Forwarding.Forwarding.{i}.MTU

# InternetGatewayDevice.LANConfigSecurity.
# InternetGatewayDevice.LANConfigSecurity.ConfigPassword

# InternetGatewayDevice.IPPingDiagnostics
# InternetGatewayDevice.IPPingDiagnostics.DiagnosticsState
# InternetGatewayDevice.IPPingDiagnostics.Interface
# InternetGatewayDevice.IPPingDiagnostics.Host
# InternetGatewayDevice.IPPingDiagnostics.NumberOfRepetitions
# InternetGatewayDevice.IPPingDiagnostics.Timeout
# InternetGatewayDevice.IPPingDiagnostics.DataBlockSize
# InternetGatewayDevice.IPPingDiagnostics.DSCP
# InternetGatewayDevice.IPPingDiagnosticsSuccessCount
# InternetGatewayDevice.IPPingDiagnosticsFailureCount
# InternetGatewayDevice.IPPingDiagnosticsAverageResponseTime
# InternetGatewayDevice.IPPingDiagnosticsMinimumResponseTmie
# InternetGatewayDevice.IPPingDiagnosticsMaximumResponseTime

# InternetGatewayDevice.LANDevice.{i}
# InternetGatewayDevice.LANDevice.{i}LANEthernetInterfaceNumberOfEntries
# InternetGatewayDevice.LANDevice.{i}LANUSBInterfaceNumberOfEntries
# InternetGatewayDevice.LANDevice.{i}LANWLANConfigurationNumberOfEntries

# InternetGatewayDevice.LANDevice.{i}.LANHostConfigManagement.
# InternetGatewayDevice.LANDevice.{i}.LANHostConfigManagement.DHCPServerConfigurable
# InternetGatewayDevice.LANDevice.{i}.LANHostConfigManagement.DHCPServerEnable
# InternetGatewayDevice.LANDevice.{i}.LANHostConfigManagement.DHCPRelay
# InternetGatewayDevice.LANDevice.{i}.LANHostConfigManagement.MinAddress
# InternetGatewayDevice.LANDevice.{i}.LANHostConfigManagement.MaxAddress
# InternetGatewayDevice.LANDevice.{i}.LANHostConfigManagement.ReservedAddresses
# InternetGatewayDevice.LANDevice.{i}.LANHostConfigManagement.SubnetMask
# InternetGatewayDevice.LANDevice.{i}.LANHostConfigManagement.DNSServers
# InternetGatewayDevice.LANDevice.{i}.LANHostConfigManagement.DomainName
# InternetGatewayDevice.LANDevice.{i}.LANHostConfigManagement.IPRouters
# InternetGatewayDevice.LANDevice.{i}.LANHostConfigManagement.DHCPLeaseTime
# InternetGatewayDevice.LANDevice.{i}.LANHostConfigManagement.UseAllocatedWAN
# InternetGatewayDevice.LANDevice.{i}.LANHostConfigManagement.AssociatedConnection
# InternetGatewayDevice.LANDevice.{i}.LANHostConfigManagement.PassthroughLease
# InternetGatewayDevice.LANDevice.{i}.LANHostConfigManagement.PassthroughMACAddress
# InternetGatewayDevice.LANDevice.{i}.LANHostConfigManagement.AllowedMACAddresses
# InternetGatewayDevice.LANDevice.{i}.LANHostConfigManagement.IPInterfaceNumberOfEntries
# InternetGatewayDevice.LANDevice.{i}.LANHostConfigManagement.IPInterface.{i}.
# InternetGatewayDevice.LANDevice.{i}.LANHostConfigManagement.IPInterface.{i}.Enable
# InternetGatewayDevice.LANDevice.{i}.LANHostConfigManagement.IPInterface.{i}.IPInterfaceIPAddress
# InternetGatewayDevice.LANDevice.{i}.LANHostConfigManagement.IPInterface.{i}.IPInterfaceSubnetMask
# InternetGatewayDevice.LANDevice.{i}.LANHostConfigManagement.IPInterface.{i}.IPInterfaceAddressingType

def wait_til
    until yield
        sleep 0.5
    end
end

require 'watir'

class Login
    def initialize(ie, username, password)
        ie.text_field(:id, 'j_username').set(username)
        ie.text_field(:id, 'j_password').set(password)
        ie.form(:name, 'loginForm').submit
        if ie.text.include? 'Logon Error'
            $stderr.print "Login to Motive server fails"
            exit
        end
    end
end

class Lock
    def initialize(ie)
        @ie = ie
        if @ie.span(:id, 'deviceInfoLockedStatus').text == 'Unlocked'
            @ie.button(:id, 'lockDeviceButton').click
            until @ie.span(:id, 'deviceInfoLockedStatus').text == 'Locked'
                sleep 0.5
            end
        end
        if  @ie.span(:class, 'user_name').text.chomp(' [ Log Off ]') != @ie.span(:id, 'deviceInfoLockedBy').text
            $stderr.print "Unable to lock device"
            exit
        end
    end
    def release
        @ie.button(:id, 'lockDeviceButton').click
    end
end

class Parameter
    def initialize(ie, frame)
        @ie = ie
        @frame = frame
    end
    def at(path)
        @path = path
    end
    def to(path)
        @path += '.' + path
    end
    def set(type, name, value)
        puts "Setting: " + @path + '.' + name
        @ie.frame(:id, @frame).select_list(:id, 'selectedParameterType').set(type)
        @ie.frame(:id, @frame).text_field(:id, 'selectedParameterName').set(@path + '.' + name)
        @ie.frame(:id, @frame).text_field(:id, 'selectedParameterValue').set(value)
        @ie.frame(:id, @frame).button(:id, 'addValue_span').click
    end
end

$HIDE_IE = true

ie = Watir::IE.start('http://xatechdm.xdev.motive.com/hdm')

puts 'Logging in to Motive server ...'

Login.new(ie, username, password)

# ie.text_field(:id, 'j_username').set('ps_training')
# ie = Watir::IE.start('http://xatechdm.xdev.motive.com/hdm')
# ie.text_field(:id, 'j_username').set('ps_training')
# ie.text_field(:id, 'j_password').set('celab123')
# ie.form(:name, 'loginForm').submit

ie.link(:href, 'http://xatechdm.xdev.motive.com/hdm/device/findDevices.do').click
ie.select_list(:id, 'searchProfile').set('Find Devices by Serial Number')

puts 'Locating device, serial: ' + serial + ' ...'

ie.text_field(:id, 'parameter_serialNumber').set(serial)

ie.button(:id, 'findDevices_span').click

if ! ie.button(:id, 'disableDevice_span').exists?
    $stderr.print "Unable to locate device"
    exit
end

puts 'Loading device data ...'

ie.button(:id, 'disableDevice_span').click

lock = Lock.new(ie)

ie.li(:id, 'queueFuctionContainer').fire_event('onclick')

ie.select_list(:id, 'actionCombo').set('Set Parameter Values')

ie.button(:id, 'queueButton_span').click

parameter = Parameter.new(ie, 'dialogFrame')

puts 'Setting parameters ...'

parameter.at('InternetGatewayDevice.LANDevice.1.LANHostConfigManagement')
parameter.set('boolean', 'DHCPServerEnable', 'true')
parameter.set('string', 'MinAddress', '192.168.1.100')
parameter.set('string', 'MaxAddress', '192.168.1.199')
parameter.at('InternetGatewayDevice.Firewall')
parameter.set('string', 'Config', 'Low')

# ie.frame(:id, 'dialogFrame').select_list(:id, 'selectedParameterType').set('boolean')
# ie.frame(:id, 'dialogFrame').text_field(:id, 'selectedParameterName').set('InternetGatewayDevice.LANDevice.1.LANHostConfigManagement.DHCPServerEnable')
# ie.frame(:id, 'dialogFrame').text_field(:id, 'selectedParameterValue').set('false')
# ie.frame(:id, 'dialogFrame').button(:id, 'addValue_span').click
# ie.frame(:id, 'dialogFrame').select_list(:id, 'selectedParameterType').set('string')
# ie.frame(:id, 'dialogFrame').text_field(:id, 'selectedParameterName').set('InternetGatewayDevice.LANDevice.1.LANHostConfigManagement.MinAddress')
# ie.frame(:id, 'dialogFrame').text_field(:id, 'selectedParameterValue').set('192.168.1.100')
# ie.frame(:id, 'dialogFrame').button(:id, 'addValue_span').click
# ie.frame(:id, 'dialogFrame').select_list(:id, 'selectedParameterType').set('string')
# ie.frame(:id, 'dialogFrame').text_field(:id, 'selectedParameterName').set('InternetGatewayDevice.LANDevice.1.LANHostConfigManagement.MaxAddress')
# ie.frame(:id, 'dialogFrame').text_field(:id, 'selectedParameterValue').set('192.168.1.150')
# ie.frame(:id, 'dialogFrame').button(:id, 'addValue_span').click
# ie.frame(:id, 'dialogFrame').select_list(:id, 'selectedParameterType').set('string')
# ie.frame(:id, 'dialogFrame').text_field(:id, 'selectedParameterName').set('InternetGatewayDevice.Firewall.Config')
# ie.frame(:id, 'dialogFrame').text_field(:id, 'selectedParameterValue').set('High')
# ie.frame(:id, 'dialogFrame').button(:id, 'addValue_span').click

puts 'Committing data parameters to device ...'

ie.frame(:id, 'dialogFrame').button(:id, 'okButtton_span').click
ie.span(:id => 'done_span', :text => 'Queue').click
ie.frame(:id, 'dialogFrame').text_field(:id, 'expirationTimeOut').set('2000')
ie.frame(:id, 'dialogFrame').button(:id, 'yes_span').click

wait_til { ie.image(:alt, 'Abort Function').exists? }
wait_til { ! ie.image(:alt, 'Abort Function').exists? }

puts 'Shutting down connection ...'

lock.release
ie.span(:id => 'done_span', :text => 'Finished').click

ie.link(:text, 'Log Off').click
ie.close

# InternetGatewayDevice.LANDevice.{i}.LANEthernetInterfaceConfig.{i}.
# InternetGatewayDevice.LANDevice.{i}.LANEthernetInterfaceConfig.{i}.Enable
# InternetGatewayDevice.LANDevice.{i}.LANEthernetInterfaceConfig.{i}.Status
# InternetGatewayDevice.LANDevice.{i}.LANEthernetInterfaceConfig.{i}.MACAddress
# InternetGatewayDevice.LANDevice.{i}.LANEthernetInterfaceConfig.{i}.MACAddressControlEnabled
# InternetGatewayDevice.LANDevice.{i}.LANEthernetInterfaceConfig.{i}.MaxBitRate
# InternetGatewayDevice.LANDevice.{i}.LANEthernetInterfaceConfig.{i}.DuplexMode
# InternetGatewayDevice.LANDevice.{i}.LANEthernetInterfaceConfig.{i}.Stats.
# InternetGatewayDevice.LANDevice.{i}.LANEthernetInterfaceConfig.{i}.Stats.BytesSent
# InternetGatewayDevice.LANDevice.{i}.LANEthernetInterfaceConfig.{i}.Stats.BytesReceived
# InternetGatewayDevice.LANDevice.{i}.LANEthernetInterfaceConfig.{i}.Stats.PacketsSent
# InternetGatewayDevice.LANDevice.{i}.LANEthernetInterfaceConfig.{i}.Stats.PacketsReceived

# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.Enable
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.Status
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.BSSID
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.MaxBitRate
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.Channel
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.SSID
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.BeaconType
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.MACAddressControlEnabled
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.Standard
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.WEPKeyIndex
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.KeyPassphrase
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.WEPEncryptionLevel
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.BasicEncryptionModes
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.BasicAuthenticationMode
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.WPAEncryptionModes
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.WPAAuthenticationMode
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.IEEE11iEncryptionModes
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.IEEE11iAuthenticationMode
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.PossibleChannels
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.BasicDataTransmitRates
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.OperationalDataTransmitRates
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.PossibleDataTransmitRates
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.InsecureOOBAccessEnabled
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.BeaconAdvertisementEnabled
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.RadioEnabled
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.AutoRateFallBackEnabled
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.LocationDescription
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.ChannelsInUse
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.DeviceOperationMode
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.DistanceFromRoot
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.PeerBSSID
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.AuthenticationServiceMode
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.TotalBytesSent
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.TotalBytesReceived
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.TotalPacketsSent
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.TotalPacketsReceived
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.TotalAssociations
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.AssociatedDevice.{i}.
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.AssociatedDevice.{i}.AssociatedDeviceMACAddress
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.AssociatedDevice.{i}.AssociatedDeviceIPAddress
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.AssociatedDevice.{i}.AssociatedDeviceAuthenticationState
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.AssociatedDevice.{i}.LastRequestedUnicastCipher
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.AssociatedDevice.{i}.LastRequestedMulticastCipher
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.AssociatedDevice.{i}.LastPMKId
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.WEPKey.{i}.
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.WEPKey.{i}.WEPKey
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.PreSharedKey.{i}.
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.PreSharedKey.{i}.PreSharedKey
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.PreSharedKey.{i}.KeyPassphrase
# InternetGatewayDevice.LANDevice.{i}.WLANConfiguration.{i}.PreSharedKey.{i}.AssociatedDeviceMACAddress
# 
# InternetGatewayDevice.LANDevice.{i}.Hosts.
# InternetGatewayDevice.LANDevice.{i}.Hosts.HostNumberOfEntries
# InternetGatewayDevice.LANDevice.{i}.Hosts.Host.{i}.
# InternetGatewayDevice.LANDevice.{i}.Hosts.Host.{i}.IPAddress
# InternetGatewayDevice.LANDevice.{i}.Hosts.Host.{i}.AddressSource
# InternetGatewayDevice.LANDevice.{i}.Hosts.Host.{i}.LeaseTimeRemaining
# InternetGatewayDevice.LANDevice.{i}.Hosts.Host.{i}.MACAddress
# InternetGatewayDevice.LANDevice.{i}.Hosts.Host.{i}.HostName
# InternetGatewayDevice.LANDevice.{i}.Hosts.Host.{i}.InterfaceType
# InternetGatewayDevice.LANDevice.{i}.Hosts.Host.{i}.Active

# InternetGatewayDevice.WANDevice.{i}.
# InternetGatewayDevice.WANDevice.{i}.WANConnectionNumberOfEntries
# InternetGatewayDevice.WANDevice.{i}.WANCommonInterfaceConfig.
# InternetGatewayDevice.WANDevice.{i}.WANCommonInterfaceConfig.EnabledForInternet
# InternetGatewayDevice.WANDevice.{i}.WANCommonInterfaceConfig.WANAccessType
# InternetGatewayDevice.WANDevice.{i}.WANCommonInterfaceConfig.Layer1UpstreamMaxBitRate
# InternetGatewayDevice.WANDevice.{i}.WANCommonInterfaceConfig.Layer1DownstreamMaxBitRate
# InternetGatewayDevice.WANDevice.{i}.WANCommonInterfaceConfig.PhysicalLinkStatus
# InternetGatewayDevice.WANDevice.{i}.WANCommonInterfaceConfig.WANAccessProvider
# InternetGatewayDevice.WANDevice.{i}.WANCommonInterfaceConfig.TotalBytesSent
# InternetGatewayDevice.WANDevice.{i}.WANCommonInterfaceConfig.TotalBytesReceived
# InternetGatewayDevice.WANDevice.{i}.WANCommonInterfaceConfig.TotalPacketsSent
# InternetGatewayDevice.WANDevice.{i}.WANCommonInterfaceConfig.TotalPacketsReceived
# InternetGatewayDevice.WANDevice.{i}.WANCommonInterfaceConfig.MaximumActiveConnections
# InternetGatewayDevice.WANDevice.{i}.WANCommonInterfaceConfig.NumberOfActiveConnections
# InternetGatewayDevice.WANDevice.{i}.WANCommonInterfaceConfig.Connection.{i}.
# InternetGatewayDevice.WANDevice.{i}.WANCommonInterfaceConfig.Connection.{i}.ActiveConnectionDeviceContainer
# InternetGatewayDevice.WANDevice.{i}.WANCommonInterfaceConfig.Connection.{i}.ActiveConnectionServiceID

# InternetGatewayDevice.WANDevice.{i}.WANEthernetInterfaceConfig.
# InternetGatewayDevice.WANDevice.{i}.WANEthernetInterfaceConfig.Enable
# InternetGatewayDevice.WANDevice.{i}.WANEthernetInterfaceConfig.Status
# InternetGatewayDevice.WANDevice.{i}.WANEthernetInterfaceConfig.MACAddress
# InternetGatewayDevice.WANDevice.{i}.WANEthernetInterfaceConfig.MaxBitRate
# InternetGatewayDevice.WANDevice.{i}.WANEthernetInterfaceConfig.DuplexMode
# InternetGatewayDevice.WANDevice.{i}.WANEthernetInterfaceConfig.Stats.
# InternetGatewayDevice.WANDevice.{i}.WANEthernetInterfaceConfig.Stats.BytesSent
# InternetGatewayDevice.WANDevice.{i}.WANEthernetInterfaceConfig.Stats.BytesReceived
# InternetGatewayDevice.WANDevice.{i}.WANEthernetInterfaceConfig.Stats.PacketsSent
# InternetGatewayDevice.WANDevice.{i}.WANEthernetInterfaceConfig.Stats.PacketsReceived

# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnectionNumberOfEntries
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnectionNumberOfEntries

# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANEthernetLinkConfig.
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANEthernetLinkConfig.EthernetLinkStatus

# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.Enable
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.ConnectionStatus
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.PossibleConnectionTypes
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.ConnectionType
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.Name
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.Uptime
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.LastConnectionError
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.AutoDisconnectTime
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.IdleDisconnectTime
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.WarnDisconnectDelay
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.RSIPAvailable
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.NATEnabled
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.AddressingType
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.ExternalIPAddress
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.SubnetMask
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.DefaultGateway
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.DNSEnabled
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.DNSOverrideAllowed
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.DNSServers
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.MaxMTUSize
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.MACAddress
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.MACAddressOverride
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.ConnectionTrigger
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.RouteProtocolRx
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.PortMappingNumberOfEntries
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.PortMapping.{i}.
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.PortMapping.{i}.PortMappingEnabled
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.PortMapping.{i}.PortMappingLeaseDuration
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.PortMapping.{i}.RemoteHost
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.PortMapping.{i}.ExternalPort
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.PortMapping.{i}.InternalPort
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.PortMapping.{i}.PortMappingProtocol
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.PortMapping.{i}.InternalClient
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.PortMapping.{i}.PortMappingDescription
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.Stats.
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.Stats.EthernetBytesSent
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.Stats.EthernetBytesReceived
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.Stats.EthernetPacketsSent
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANIPConnection.{i}.Stats.EthernetPacketsReceived

puts 'attempting connection to slave target machine ...'

if `ping -n 1 #{target}` =~ /unreachable/
    puts "attempted connection to #{target} failed"
else
    puts "connection to #{target} succeeded"
end

# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.Enable
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.ConnectionStatus
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.PossibleConnectionTypes
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.ConnectionType
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.Name
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.Uptime
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.LastConnectionError
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.AutoDisconnectTime
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.IdleDisconnectTime
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.WarnDisconnectDelay
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.RSIPAvailable
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.NATEnabled
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.Username
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.Password
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.PPPEncryptionProtocol
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.PPPCompressionProtocol
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.PPPAuthenticationProtocol
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.ExternalIPAddress
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.RemoteIPAddress
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.MaxMRUSize
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.CurrentMRUSize
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.DNSEnabled
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.DNSOverrideAllowed
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.DNSServers
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.MACAddress
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.MACAddressOverride
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.TransportType
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.PPPoEACName
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.PPPoEServiceName
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.ConnectionTrigger
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.RouteProtocolRx
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.PPPLCPEcho
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.PPPLCPEchoRetry
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.PortMappingNumberOfEntries
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.PortMapping.{i}.
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.PortMapping.{i}.PortMappingEnabled
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.PortMapping.{i}.PortMappingLeaseDuration
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.PortMapping.{i}.RemoteHost
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.PortMapping.{i}.ExternalPort
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.PortMapping.{i}.InternalPort
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.PortMapping.{i}.PortMappingProtocol
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.PortMapping.{i}.InternalClient
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.PortMapping.{i}.PortMappingDescription
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.Stats.
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.Stats.EthernetBytesSent
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.Stats.EthernetBytesReceived
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.Stats.EthernetPacketsSent
# InternetGatewayDevice.WANDevice.{i}.WANConnectionDevice.{i}.WANPPPConnection.{i}.Stats.EthernetPacketsReceived
