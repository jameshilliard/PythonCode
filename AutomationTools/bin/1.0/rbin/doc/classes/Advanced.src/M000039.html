<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html>
<head>
  <title>qos_add_rule (Advanced)</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
</head>
<body class="standalone-code">
  <pre><span class="ruby-comment cmt"># File Advanced/Advanced.rb, line 1014</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">qos_add_rule</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">rule_id</span>,<span class="ruby-identifier">data</span>,<span class="ruby-identifier">qkey</span>)
            <span class="ruby-comment cmt"># RJS</span>
            <span class="ruby-comment cmt"># add code to check to see if we are tying to add a rule that already exists</span>
            <span class="ruby-comment cmt"># if so exit with a warning message</span>
            <span class="ruby-comment cmt"># </span>
            <span class="ruby-identifier">base</span> = <span class="ruby-identifier">qkey</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'-rule-'</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">rule_id</span> <span class="ruby-operator">+</span><span class="ruby-value str">'-'</span>
            <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">data</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value str">'source'</span>)
               <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:debug</span>, <span class="ruby-value str">&quot;qos_add&quot;</span>, <span class="ruby-value str">&quot;found source:&quot;</span><span class="ruby-operator">+</span> <span class="ruby-identifier">data</span>[<span class="ruby-value str">'source'</span>].<span class="ruby-identifier">to_s</span>)
               <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">data</span>[<span class="ruby-value str">'source'</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;any&quot;</span>
                   <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:debug</span>, <span class="ruby-value str">'qos_add_rule'</span>, <span class="ruby-value str">&quot;found any&quot;</span>)
                   <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'sym_net_obj_src'</span>).<span class="ruby-identifier">select_value</span>(<span class="ruby-value str">'ANY'</span>)
                   <span class="ruby-comment cmt">#@ff.link(:text, 'Apply').click</span>
                   <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:info</span>, <span class="ruby-identifier">base</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'source-any'</span>, <span class="ruby-value str">'done'</span>)
               <span class="ruby-keyword kw">else</span>
               <span class="ruby-identifier">sources</span> = <span class="ruby-identifier">data</span>[<span class="ruby-value str">'source'</span>]
               <span class="ruby-identifier">sources</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">source</span>,<span class="ruby-identifier">src_info</span><span class="ruby-operator">|</span>
                  <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:info</span>, <span class="ruby-identifier">base</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'source-'</span> <span class="ruby-operator">+</span><span class="ruby-identifier">source</span>, <span class="ruby-value str">'done'</span>)
                   <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">source</span> <span class="ruby-operator">==</span> <span class="ruby-value str">'ip_address'</span> 
                       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:debug</span>, <span class="ruby-value str">'qos_add_rule'</span>, <span class="ruby-identifier">src_info</span>)
                       <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'sym_net_obj_src'</span>).<span class="ruby-identifier">select_value</span>(<span class="ruby-value str">'USER_DEFINED'</span>)
                       <span class="ruby-identifier">qos_add_ip</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">src_info</span>)
                       <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">link</span>(<span class="ruby-identifier">:text</span>, <span class="ruby-value str">'Apply'</span>).<span class="ruby-identifier">click</span>
                   <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">source</span> <span class="ruby-operator">==</span> <span class="ruby-value str">'ip_subnet'</span> 
                       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:debug</span>, <span class="ruby-value str">'qos_add_rule'</span>, <span class="ruby-value str">&quot;subnet = &quot;</span> <span class="ruby-operator">+</span><span class="ruby-identifier">src_info</span>)
                       <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'sym_net_obj_src'</span>).<span class="ruby-identifier">select_value</span>(<span class="ruby-value str">'USER_DEFINED'</span>)
                       <span class="ruby-identifier">qos_add_2_ip</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">src_info</span>,<span class="ruby-value">1</span>)
                       <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">link</span>(<span class="ruby-identifier">:text</span>, <span class="ruby-value str">'Apply'</span>).<span class="ruby-identifier">click</span>
                   <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">source</span> <span class="ruby-operator">==</span><span class="ruby-value str">'ip_range'</span>
                       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:debug</span>, <span class="ruby-value str">'qos_add_rule'</span>, <span class="ruby-value str">&quot;range = &quot;</span> <span class="ruby-operator">+</span><span class="ruby-identifier">src_info</span>)
                       <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'sym_net_obj_src'</span>).<span class="ruby-identifier">select_value</span>(<span class="ruby-value str">'USER_DEFINED'</span>)
                       <span class="ruby-identifier">qos_add_2_ip</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">src_info</span>,<span class="ruby-value">2</span>)
                       <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">link</span>(<span class="ruby-identifier">:text</span>, <span class="ruby-value str">'Apply'</span>).<span class="ruby-identifier">click</span>
                   <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">source</span> <span class="ruby-operator">==</span><span class="ruby-value str">'mac'</span>
                       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:debug</span>, <span class="ruby-value str">'qos_add_rule'</span>, <span class="ruby-value str">&quot;mac = &quot;</span> <span class="ruby-operator">+</span><span class="ruby-identifier">src_info</span>)
                       <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'sym_net_obj_src'</span>).<span class="ruby-identifier">select_value</span>(<span class="ruby-value str">'USER_DEFINED'</span>)
                       <span class="ruby-identifier">qos_add_mac</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">src_info</span>)
                       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:debug</span>, <span class="ruby-value str">'qos_add_rule'</span>, <span class="ruby-value str">&quot;mac is done &quot;</span>)
                       <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">link</span>(<span class="ruby-identifier">:text</span>, <span class="ruby-value str">'Apply'</span>).<span class="ruby-identifier">click</span>
                   <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">source</span> <span class="ruby-operator">==</span><span class="ruby-value str">'host'</span>
                       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:debug</span>, <span class="ruby-value str">'qos_add_rule'</span>, <span class="ruby-value str">&quot;host = &quot;</span> <span class="ruby-operator">+</span><span class="ruby-identifier">src_info</span>)
                       <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'sym_net_obj_src'</span>).<span class="ruby-identifier">select_value</span>(<span class="ruby-value str">'USER_DEFINED'</span>)
                       <span class="ruby-identifier">qos_add_host</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">src_info</span>)
                       <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">link</span>(<span class="ruby-identifier">:text</span>, <span class="ruby-value str">'Apply'</span>).<span class="ruby-identifier">click</span>
                   <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">source</span> <span class="ruby-operator">==</span><span class="ruby-value str">'dhcp_option'</span>
                       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:debug</span>, <span class="ruby-value str">'qos_add_rule'</span>, <span class="ruby-value str">&quot;dhcp = &quot;</span> <span class="ruby-operator">+</span><span class="ruby-identifier">src_info</span>)
                       <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'sym_net_obj_src'</span>).<span class="ruby-identifier">select_value</span>(<span class="ruby-value str">'USER_DEFINED'</span>)
                       <span class="ruby-identifier">qos_add_dhcp_option</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">src_info</span>)
                       <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">link</span>(<span class="ruby-identifier">:text</span>, <span class="ruby-value str">'Apply'</span>).<span class="ruby-identifier">click</span>
                   <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">source</span> <span class="ruby-operator">==</span><span class="ruby-value str">'discovered_hosts'</span>
                       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:debug</span>, <span class="ruby-value str">'qos_add_rule'</span>, <span class="ruby-value str">&quot;discovered_hosts &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">src_info</span>)
                       <span class="ruby-identifier">host_list</span> = <span class="ruby-identifier">src_info</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">','</span>)
                       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:debug</span>, <span class="ruby-value str">'qos_add_host'</span>, <span class="ruby-value str">&quot;host_list&quot;</span> <span class="ruby-operator">+</span><span class="ruby-identifier">host_list</span>.<span class="ruby-identifier">to_s</span>)
                       <span class="ruby-identifier">disc_host</span>= <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'sym_net_obj_src'</span>).<span class="ruby-identifier">getAllContents</span>
                       <span class="ruby-comment cmt"># for each host int the config data scan the select list to see if that</span>
                       <span class="ruby-comment cmt"># host is in the pull down. If so select it, if not print an error</span>
                       <span class="ruby-comment cmt">#</span>
                       <span class="ruby-identifier">host_list</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">host</span><span class="ruby-operator">|</span>
                           <span class="ruby-identifier">found</span> = <span class="ruby-keyword kw">false</span>
                           <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:debug</span>, <span class="ruby-value str">'qos_add_host'</span>, <span class="ruby-value str">&quot;processing host&quot;</span> <span class="ruby-operator">+</span><span class="ruby-identifier">host</span>.<span class="ruby-identifier">to_s</span>)
                            <span class="ruby-identifier">disc_host</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">el</span><span class="ruby-operator">|</span>
                              <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">host</span>.<span class="ruby-identifier">strip</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">el</span>
                                  <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'sym_net_obj_src'</span>).<span class="ruby-identifier">select</span>(<span class="ruby-identifier">el</span>)
                                  <span class="ruby-identifier">found</span> = <span class="ruby-keyword kw">true</span>
                              <span class="ruby-keyword kw">end</span>
                           <span class="ruby-keyword kw">end</span> 
                           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">found</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">false</span>
                               <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:error</span>, <span class="ruby-value str">'qos_add_rule'</span>, <span class="ruby-value str">&quot;cannot find discovered_hosts &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">host</span>.<span class="ruby-identifier">strip</span>)
                           <span class="ruby-keyword kw">end</span>
                      <span class="ruby-keyword kw">end</span>

                       <span class="ruby-comment cmt">#@ff.link(:text, 'Apply').click</span>
                   <span class="ruby-keyword kw">end</span>
                <span class="ruby-keyword kw">end</span>
                <span class="ruby-keyword kw">end</span>
            <span class="ruby-keyword kw">end</span>
            <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">data</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value str">'destination'</span>)
               <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:debug</span>,<span class="ruby-value str">&quot;qos_add&quot;</span>, <span class="ruby-value str">&quot; found destination:&quot;</span>)
               <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:debug</span>, <span class="ruby-value str">'qos_add_rule'</span>, <span class="ruby-identifier">data</span>[<span class="ruby-value str">'destination'</span>])
               <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">data</span>[<span class="ruby-value str">'destination'</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;any&quot;</span>
                   <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'sym_net_obj_dst'</span>).<span class="ruby-identifier">select_value</span>(<span class="ruby-value str">'ANY'</span>)
                   <span class="ruby-comment cmt">#@ff.link(:text, 'Apply').click</span>
                   <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:info</span>, <span class="ruby-identifier">base</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'dest-any'</span>, <span class="ruby-value str">'done'</span>)
               <span class="ruby-keyword kw">else</span>
               <span class="ruby-identifier">dests</span> = <span class="ruby-identifier">data</span>[<span class="ruby-value str">'destination'</span>]
               <span class="ruby-identifier">dests</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">dest</span>,<span class="ruby-identifier">dest_info</span><span class="ruby-operator">|</span>
                   <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:info</span>, <span class="ruby-identifier">base</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'dest-'</span><span class="ruby-operator">+</span><span class="ruby-identifier">dest</span>, <span class="ruby-value str">'done'</span>)
                   <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">dest</span> <span class="ruby-operator">==</span><span class="ruby-value str">'ip_address'</span>
                       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:debug</span>, <span class="ruby-value str">'qos_add_rule'</span>, <span class="ruby-identifier">dest_info</span>)
                       <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'sym_net_obj_dst'</span>).<span class="ruby-identifier">select_value</span>(<span class="ruby-value str">'USER_DEFINED'</span>)
                       <span class="ruby-identifier">qos_add_ip</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">dest_info</span>)
                       <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">link</span>(<span class="ruby-identifier">:text</span>, <span class="ruby-value str">'Apply'</span>).<span class="ruby-identifier">click</span>
                   <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">dest</span> <span class="ruby-operator">==</span><span class="ruby-value str">'ip_subnet'</span>
                       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:debug</span>, <span class="ruby-value str">'qos_add_rule'</span>, <span class="ruby-value str">&quot;subnet = &quot;</span> <span class="ruby-operator">+</span><span class="ruby-identifier">dest_info</span>)
                       <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'sym_net_obj_dst'</span>).<span class="ruby-identifier">select_value</span>(<span class="ruby-value str">'USER_DEFINED'</span>)
                       <span class="ruby-identifier">qos_add_2_ip</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">dest_info</span>,<span class="ruby-value">1</span>)
                       <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">link</span>(<span class="ruby-identifier">:text</span>, <span class="ruby-value str">'Apply'</span>).<span class="ruby-identifier">click</span>
                   <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">dest</span> <span class="ruby-operator">==</span><span class="ruby-value str">'ip_range'</span>
                       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:debug</span>, <span class="ruby-value str">'qos_add_rule'</span>, <span class="ruby-value str">&quot;range = &quot;</span> <span class="ruby-operator">+</span><span class="ruby-identifier">dest_info</span>)
                       <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'sym_net_obj_dst'</span>).<span class="ruby-identifier">select_value</span>(<span class="ruby-value str">'USER_DEFINED'</span>)
                       <span class="ruby-identifier">qos_add_2_ip</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">dest_info</span>,<span class="ruby-value">2</span>)
                       <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">link</span>(<span class="ruby-identifier">:text</span>, <span class="ruby-value str">'Apply'</span>).<span class="ruby-identifier">click</span>
                   <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">dest</span> <span class="ruby-operator">==</span><span class="ruby-value str">'mac'</span>
                       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:debug</span>, <span class="ruby-value str">'qos_add_rule'</span>, <span class="ruby-value str">&quot;mac = &quot;</span> <span class="ruby-operator">+</span><span class="ruby-identifier">dest_info</span>)
                       <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'sym_net_obj_dst'</span>).<span class="ruby-identifier">select_value</span>(<span class="ruby-value str">'USER_DEFINED'</span>)
                       <span class="ruby-identifier">qos_add_mac</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">dest_info</span>)
                       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:debug</span>, <span class="ruby-value str">'qos_add_rule'</span>, <span class="ruby-value str">&quot;mac is done &quot;</span>)
                       <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">link</span>(<span class="ruby-identifier">:text</span>, <span class="ruby-value str">'Apply'</span>).<span class="ruby-identifier">click</span>
                   <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">dest</span> <span class="ruby-operator">==</span><span class="ruby-value str">'host'</span>
                       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:debug</span>, <span class="ruby-value str">'qos_add_rule'</span>, <span class="ruby-value str">&quot;host = &quot;</span> <span class="ruby-operator">+</span><span class="ruby-identifier">dest_info</span>)
                       <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'sym_net_obj_dst'</span>).<span class="ruby-identifier">select_value</span>(<span class="ruby-value str">'USER_DEFINED'</span>)
                       <span class="ruby-identifier">qos_add_host</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">dest_info</span>)
                       <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">link</span>(<span class="ruby-identifier">:text</span>, <span class="ruby-value str">'Apply'</span>).<span class="ruby-identifier">click</span>
                   <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">dest</span> <span class="ruby-operator">==</span><span class="ruby-value str">'dhcp_option'</span>
                       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:debug</span>, <span class="ruby-value str">'qos_add_rule'</span>, <span class="ruby-value str">&quot;dhcp = &quot;</span> <span class="ruby-operator">+</span><span class="ruby-identifier">dest_info</span>)
                       <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'sym_net_obj_dst'</span>).<span class="ruby-identifier">select_value</span>(<span class="ruby-value str">'USER_DEFINED'</span>)
                       <span class="ruby-identifier">qos_add_dhcp_option</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">dest_info</span>)
                       <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">link</span>(<span class="ruby-identifier">:text</span>, <span class="ruby-value str">'Apply'</span>).<span class="ruby-identifier">click</span>
                   <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">dest</span> <span class="ruby-operator">==</span><span class="ruby-value str">'discovered_hosts'</span>
                       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:debug</span>, <span class="ruby-value str">'qos_add_rule'</span>, <span class="ruby-value str">&quot;discovered_hosts &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">dest_info</span>)
                       <span class="ruby-identifier">host_list</span> = <span class="ruby-identifier">dest_info</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">','</span>)
                       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:debug</span>, <span class="ruby-value str">'qos_add_host'</span>, <span class="ruby-value str">&quot;host_list&quot;</span> <span class="ruby-operator">+</span><span class="ruby-identifier">host_list</span>.<span class="ruby-identifier">to_s</span>)
                       <span class="ruby-identifier">disc_host</span>= <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'sym_net_obj_dst'</span>).<span class="ruby-identifier">getAllContents</span>
                       <span class="ruby-comment cmt"># for each host int the config data scan the select list to see if that</span>
                       <span class="ruby-comment cmt"># host is in the pull down. If so select it, if not print an error</span>
                       <span class="ruby-comment cmt">#</span>
                       <span class="ruby-identifier">host_list</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">host</span><span class="ruby-operator">|</span>
                           <span class="ruby-identifier">found</span> = <span class="ruby-keyword kw">false</span>
                           <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:debug</span>, <span class="ruby-value str">'qos_add_host'</span>, <span class="ruby-value str">&quot;processing host&quot;</span> <span class="ruby-operator">+</span><span class="ruby-identifier">host</span>.<span class="ruby-identifier">to_s</span>)
                            <span class="ruby-identifier">disc_host</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">el</span><span class="ruby-operator">|</span>
                              <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">host</span>.<span class="ruby-identifier">strip</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">el</span>
                                  <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'sym_net_obj_dst'</span>).<span class="ruby-identifier">select</span>(<span class="ruby-identifier">el</span>)
                                  <span class="ruby-identifier">found</span> = <span class="ruby-keyword kw">true</span>
                              <span class="ruby-keyword kw">end</span>
                           <span class="ruby-keyword kw">end</span>
                           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">found</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">false</span>
                               <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:error</span>, <span class="ruby-value str">'qos_add_rule'</span>, <span class="ruby-value str">&quot;cannot find discovered_hosts &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">host</span>.<span class="ruby-identifier">strip</span>)
                           <span class="ruby-keyword kw">end</span>
                      <span class="ruby-keyword kw">end</span>

                       <span class="ruby-comment cmt">#@ff.link(:text, 'Apply').click</span>
                   <span class="ruby-keyword kw">end</span>

                   <span class="ruby-keyword kw">end</span>
                <span class="ruby-keyword kw">end</span>
            <span class="ruby-keyword kw">end</span>
            <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">data</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value str">'protocol'</span>)
               <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:debug</span>,<span class="ruby-value str">&quot;qos_add&quot;</span>, <span class="ruby-value str">&quot; found protocol:&quot;</span>)
               <span class="ruby-identifier">protos</span> =<span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'svc_service_combo'</span>).<span class="ruby-identifier">getAllContents</span>
               <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">protos</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value str">&quot;Show All Services&quot;</span>)
                    <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:debug</span>,<span class="ruby-value str">&quot;qos_add&quot;</span>, <span class="ruby-value str">&quot; displaying all services:&quot;</span>)
                     <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'svc_service_combo'</span>).<span class="ruby-identifier">select</span>(<span class="ruby-value str">&quot;Show All Services&quot;</span>)
               <span class="ruby-keyword kw">end</span>
               <span class="ruby-identifier">protos</span> =<span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'svc_service_combo'</span>).<span class="ruby-identifier">getAllContents</span>
               <span class="ruby-identifier">protocols</span> = <span class="ruby-identifier">data</span>[<span class="ruby-value str">'protocol'</span>]
               <span class="ruby-identifier">protocols</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">proto</span>,<span class="ruby-identifier">proto_info</span><span class="ruby-operator">|</span>
                   <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:info</span>, <span class="ruby-identifier">base</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'protocol-'</span><span class="ruby-operator">+</span> <span class="ruby-identifier">proto</span>, <span class="ruby-value str">'done'</span>)
                   <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">proto</span>  <span class="ruby-operator">==</span> <span class="ruby-value str">'named'</span> 
                       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:debug</span>, <span class="ruby-value str">'qos_add_rule'</span>, <span class="ruby-value str">&quot;named info = &quot;</span> <span class="ruby-operator">+</span><span class="ruby-identifier">proto_info</span>.<span class="ruby-identifier">to_s</span>)
                       <span class="ruby-identifier">proto_info</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">proto_instance</span><span class="ruby-operator">|</span> 
                           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">protos</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">proto_instance</span>)
                               <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'svc_service_combo'</span>).<span class="ruby-identifier">select</span>(<span class="ruby-identifier">proto_instance</span>)
                           <span class="ruby-keyword kw">else</span>
                              <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:debug</span>,<span class="ruby-value str">&quot;qos_add&quot;</span>, <span class="ruby-value str">&quot;protocol  &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">proto_instance</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot; not found&quot;</span>)
                           <span class="ruby-keyword kw">end</span>
                       <span class="ruby-keyword kw">end</span>
                   <span class="ruby-keyword kw">end</span>
                   <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">proto</span>  <span class="ruby-operator">==</span> <span class="ruby-value str">'user_defined'</span> 
                       <span class="ruby-identifier">qos_user_defined_proto</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">proto_info</span>)
                   <span class="ruby-keyword kw">end</span>
               <span class="ruby-keyword kw">end</span>
            <span class="ruby-keyword kw">end</span>
            <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">data</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value str">'dscp'</span>)
               <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:debug</span>,<span class="ruby-value str">&quot;qos_add&quot;</span>, <span class="ruby-value str">&quot; found dscp:&quot;</span>)
               <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">checkbox</span>(<span class="ruby-identifier">:id</span>, <span class="ruby-value str">'dscp_check_box_'</span>).<span class="ruby-identifier">set</span>
               <span class="ruby-identifier">dscp_vals</span> =  <span class="ruby-identifier">data</span>[<span class="ruby-value str">'dscp'</span>].<span class="ruby-identifier">split</span>(<span class="ruby-value str">','</span>)
               <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">dscp_vals</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">2</span>
                   <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">text_field</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'dscp_check_val'</span>).<span class="ruby-identifier">set</span>(<span class="ruby-identifier">dscp_vals</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">strip</span>) 
                   <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">text_field</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'dscp_check_mask'</span>).<span class="ruby-identifier">set</span>(<span class="ruby-identifier">dscp_vals</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">strip</span>) 
                   <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:info</span>, <span class="ruby-identifier">base</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'dscp'</span> , <span class="ruby-value str">'done'</span>)
               <span class="ruby-keyword kw">else</span>
                   <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:error</span>,<span class="ruby-value str">&quot;qos_add&quot;</span>, <span class="ruby-value str">&quot; must specify dscp and mask&quot;</span>)
               <span class="ruby-keyword kw">end</span> 
            <span class="ruby-keyword kw">end</span>
            <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">data</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value str">'priority'</span>)
               <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:debug</span>,<span class="ruby-value str">&quot;qos_add&quot;</span>, <span class="ruby-value str">&quot; found priority:&quot;</span>)
               <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">checkbox</span>(<span class="ruby-identifier">:id</span>, <span class="ruby-value str">'prio_check_box_'</span>).<span class="ruby-identifier">set</span>
               <span class="ruby-identifier">regx</span>=<span class="ruby-constant">Regexp</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">data</span>[<span class="ruby-value str">'priority'</span>]
               <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'prio_check_combo'</span>).<span class="ruby-identifier">select_value</span>(<span class="ruby-identifier">regx</span>)
               <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:info</span>, <span class="ruby-identifier">base</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'priority'</span> , <span class="ruby-value str">'done'</span>)
            <span class="ruby-keyword kw">end</span>
            <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">data</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value str">'packet_length'</span>)
               <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:debug</span>,<span class="ruby-value str">&quot;qos_add&quot;</span>, <span class="ruby-value str">&quot; found packet_length:&quot;</span>)
               <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">checkbox</span>(<span class="ruby-identifier">:id</span>, <span class="ruby-value str">'length_check_box_'</span>).<span class="ruby-identifier">set</span>
               <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'length_check_type'</span>).<span class="ruby-identifier">select_value</span>(<span class="ruby-value str">&quot;0&quot;</span>)
               <span class="ruby-identifier">len_vals</span> =  <span class="ruby-identifier">data</span>[<span class="ruby-value str">'packet_length'</span>].<span class="ruby-identifier">split</span>(<span class="ruby-value str">','</span>)
               <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">len_vals</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">2</span>
                   <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">text_field</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'length_check_from'</span>).<span class="ruby-identifier">set</span>(<span class="ruby-identifier">len_vals</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">strip</span>) 
                   <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">text_field</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'length_check_to'</span>).<span class="ruby-identifier">set</span>(<span class="ruby-identifier">len_vals</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">strip</span>) 
                   <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:info</span>, <span class="ruby-identifier">base</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'packet_length'</span> , <span class="ruby-value str">'done'</span>)
               <span class="ruby-keyword kw">else</span>
                   <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:error</span>,<span class="ruby-value str">&quot;qos_add&quot;</span>, <span class="ruby-value str">&quot; must specify from and to lengths for packet_length&quot;</span>)
               <span class="ruby-keyword kw">end</span> 
            <span class="ruby-keyword kw">end</span>
            <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">data</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value str">'data_length'</span>)
               <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:debug</span>,<span class="ruby-value str">&quot;qos_add&quot;</span>, <span class="ruby-value str">&quot; found data_length:&quot;</span>)
               <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">checkbox</span>(<span class="ruby-identifier">:id</span>, <span class="ruby-value str">'length_check_box_'</span>).<span class="ruby-identifier">set</span>
               <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'length_check_type'</span>).<span class="ruby-identifier">select_value</span>(<span class="ruby-value str">&quot;1&quot;</span>)
               <span class="ruby-identifier">len_vals</span> =  <span class="ruby-identifier">data</span>[<span class="ruby-value str">'data_length'</span>].<span class="ruby-identifier">split</span>(<span class="ruby-value str">','</span>)
               <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">len_vals</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">2</span>
                   <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">text_field</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'length_check_from'</span>).<span class="ruby-identifier">set</span>(<span class="ruby-identifier">len_vals</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">strip</span>) 
                   <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">text_field</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'length_check_to'</span>).<span class="ruby-identifier">set</span>(<span class="ruby-identifier">len_vals</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">strip</span>) 
                   <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:info</span>, <span class="ruby-identifier">base</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'data_length'</span> , <span class="ruby-value str">'done'</span>)
               <span class="ruby-keyword kw">else</span>
                   <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:error</span>,<span class="ruby-value str">&quot;qos_add&quot;</span>, <span class="ruby-value str">&quot; must specify from and to lengths data_length&quot;</span>)
               <span class="ruby-keyword kw">end</span> 
            <span class="ruby-keyword kw">end</span>
            <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">data</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value str">'dscp_auto'</span>)
               <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:debug</span>,<span class="ruby-value str">&quot;qos_add&quot;</span>, <span class="ruby-value str">&quot; found specify_dscp:&quot;</span>)
               <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">checkbox</span>(<span class="ruby-identifier">:id</span>, <span class="ruby-value str">'length_check_box_'</span>).<span class="ruby-identifier">set</span>
               <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:info</span>, <span class="ruby-identifier">base</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'dscp_auto'</span> , <span class="ruby-value str">'done'</span>)
            <span class="ruby-keyword kw">end</span>
            <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">data</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value str">'set_dscp'</span>)
               <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:debug</span>,<span class="ruby-value str">&quot;qos_add&quot;</span>, <span class="ruby-value str">&quot; found specify_dscp:&quot;</span>)
               <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">checkbox</span>(<span class="ruby-identifier">:id</span>, <span class="ruby-value str">'set_dscp_check_'</span>).<span class="ruby-identifier">set</span>
               <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">data</span>[<span class="ruby-value str">'set_dscp'</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">'auto'</span>
                  <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'set_dscp'</span>).<span class="ruby-identifier">select_value</span>(<span class="ruby-value str">&quot;1&quot;</span>)
               <span class="ruby-keyword kw">else</span>
                  <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'set_dscp'</span>).<span class="ruby-identifier">select_value</span>(<span class="ruby-value str">&quot;2&quot;</span>)
                   <span class="ruby-identifier">dscp_vals</span> =  <span class="ruby-identifier">data</span>[<span class="ruby-value str">'set_dscp'</span>].<span class="ruby-identifier">split</span>(<span class="ruby-value str">','</span>)
                   <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">dscp_vals</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">2</span>
                       <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">text_field</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'qos_dscp_edit'</span>).<span class="ruby-identifier">set</span>(<span class="ruby-identifier">dscp_vals</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">strip</span>) 
                       <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">text_field</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'qos_dscp_mask'</span>).<span class="ruby-identifier">set</span>(<span class="ruby-identifier">dscp_vals</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">strip</span>) 
                   <span class="ruby-keyword kw">else</span>
                       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:error</span>,<span class="ruby-value str">&quot;qos_add&quot;</span>, <span class="ruby-value str">&quot; must specify dscp and mask when setting dscp vals&quot;</span>)
                   <span class="ruby-keyword kw">end</span> 
               <span class="ruby-keyword kw">end</span> 
               <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:info</span>, <span class="ruby-identifier">base</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'set_dscp'</span> , <span class="ruby-value str">'done'</span>)
            <span class="ruby-keyword kw">end</span>
            <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">data</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value str">'set_priority'</span>)
               <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:debug</span>,<span class="ruby-value str">&quot;qos_add&quot;</span>, <span class="ruby-value str">&quot; found set_priority:&quot;</span>)
               <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">checkbox</span>(<span class="ruby-identifier">:id</span>, <span class="ruby-value str">'set_priority_'</span>).<span class="ruby-identifier">set</span>
               <span class="ruby-identifier">regx</span>=<span class="ruby-constant">Regexp</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">data</span>[<span class="ruby-value str">'set_priority'</span>]
               <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'qos_8021p_combo'</span>).<span class="ruby-identifier">select_value</span>(<span class="ruby-identifier">regx</span>)
               <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:info</span>, <span class="ruby-identifier">base</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'set_priority'</span> , <span class="ruby-value str">'done'</span>)
            <span class="ruby-keyword kw">end</span>
            <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">data</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value str">'apply'</span>)
               <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:debug</span>,<span class="ruby-value str">&quot;qos_add&quot;</span>, <span class="ruby-value str">&quot; found apply:&quot;</span>)
               <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">data</span>[<span class="ruby-value str">'apply'</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;packet&quot;</span>
                 <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'qos_on_conn'</span>).<span class="ruby-identifier">select_value</span>(<span class="ruby-value str">&quot;0&quot;</span>)
               <span class="ruby-keyword kw">end</span>
               <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">data</span>[<span class="ruby-value str">'apply'</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;connection&quot;</span>
                 <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'qos_on_conn'</span>).<span class="ruby-identifier">select_value</span>(<span class="ruby-value str">&quot;1&quot;</span>)
               <span class="ruby-keyword kw">end</span>
               <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:info</span>, <span class="ruby-identifier">base</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'apply'</span> , <span class="ruby-value str">'done'</span>)
                 
            <span class="ruby-keyword kw">end</span>
            <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">data</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value str">'logging'</span>)
               <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:debug</span>,<span class="ruby-value str">&quot;qos_add&quot;</span>, <span class="ruby-value str">&quot; found logging:&quot;</span>)
               <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">data</span>[<span class="ruby-value str">'logging'</span>] <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
                   <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">checkbox</span>(<span class="ruby-identifier">:id</span>, <span class="ruby-value str">'rule_log_'</span>).<span class="ruby-identifier">set</span>
               <span class="ruby-keyword kw">end</span>
               <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">data</span>[<span class="ruby-value str">'logging'</span>] <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
                   <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">checkbox</span>(<span class="ruby-identifier">:id</span>, <span class="ruby-value str">'rule_log_'</span>).<span class="ruby-identifier">clear</span>
               <span class="ruby-keyword kw">end</span>
               <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:info</span>, <span class="ruby-identifier">base</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'logging'</span> , <span class="ruby-value str">'done'</span>)
            <span class="ruby-keyword kw">end</span>
            <span class="ruby-comment cmt"># rjs</span>
            <span class="ruby-comment cmt"># do when here</span>
            <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">data</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value str">'when'</span>)
               <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:debug</span>,<span class="ruby-value str">&quot;qos_rule&quot;</span>, <span class="ruby-value str">&quot; found when&quot;</span>)
               <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">data</span>[<span class="ruby-value str">'when'</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">'always'</span>
                 <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'schdlr_rule_id'</span>).<span class="ruby-identifier">select</span>(<span class="ruby-value str">&quot;Always&quot;</span>)
               <span class="ruby-keyword kw">else</span>
                 <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'schdlr_rule_id'</span>).<span class="ruby-identifier">select</span>(<span class="ruby-value str">&quot;User Defined&quot;</span>)
                 <span class="ruby-identifier">qos_scheduler</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">data</span>[<span class="ruby-value str">'when'</span>])
               <span class="ruby-keyword kw">end</span>
               <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:info</span>, <span class="ruby-identifier">base</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'scheduler'</span> , <span class="ruby-value str">'done'</span>)
             <span class="ruby-keyword kw">end</span>
            <span class="ruby-comment cmt">#</span>
            <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">link</span>(<span class="ruby-identifier">:text</span>, <span class="ruby-value str">'Apply'</span>).<span class="ruby-identifier">click</span>
        <span class="ruby-keyword kw">end</span></pre>
</body>
</html>