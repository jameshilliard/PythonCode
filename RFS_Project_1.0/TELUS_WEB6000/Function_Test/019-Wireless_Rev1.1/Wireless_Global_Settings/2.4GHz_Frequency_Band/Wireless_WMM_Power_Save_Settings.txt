*** Settings ***
Suite Teardown    TR_SPV_WMM_Enable
Resource          ../../../../Variables_ENV.txt
Resource          ../../../../Share_Resource.txt
Resource          ../../../../GUI_Keyword.txt

*** Test Cases ***
RFW-T6000-12566:WMM Power-Save Is Disabled: Packet Analysis
    [Setup]    TR_SPV_WMM_Enable
    #1. Disable WMM on DUT.    2. Captuer Beacon and Probe Response packets sent by DUT.
    TR_SPV    Device.WiFi.AccessPoint.1.UAPSDEnable=0 boolean
    FUN_Parse WiFi_L2 Packets    wlan.fc.type_subtype == 0x08 and wlan.bssid == ${U_WIRELESS_2G_BSSID1} and wlan_mgt.wfa.ie.wme.qos_info.ap.u_apsd == 0    True    #Capture Beacon
    FUN_Parse WiFi_L2 Packets    wlan.fc.type_subtype == 0x05 and wlan.bssid == ${U_WIRELESS_2G_BSSID1} and wlan_mgt.wfa.ie.wme.qos_info.ap.u_apsd == 0    True    #Capture Probe Response
    #3. Go to check Expected Results.    Do GUI Check: WMM status can be shown correctly on corresponding Web GUI pages.
    Comment    GUI_Check_WMM_2G    ${U_DUT_BR0_IP}    ${U_DUT_HTTP_USER}    ${U_DUT_HTTP_PWD}    off
    #4. Reboot DUT.
    Comment    TR_Reboot_DUT
    FUN_Parse WiFi_L2 Packets    wlan.fc.type_subtype == 0x08 and wlan.bssid == ${U_WIRELESS_2G_BSSID1} and wlan_mgt.wfa.ie.wme.qos_info.ap.u_apsd == 0    True    #Capture Beacon
    FUN_Parse WiFi_L2 Packets    wlan.fc.type_subtype == 0x05 and wlan.bssid == ${U_WIRELESS_2G_BSSID1} and wlan_mgt.wfa.ie.wme.qos_info.ap.u_apsd == 0    True    #Capture Probe Response
    Comment    GUI_Check_WMM_2G    ${U_DUT_BR0_IP}    ${U_DUT_HTTP_USER}    ${U_DUT_HTTP_PWD}    off

RFW-T6000-12567:WMM Power-Save Is Enabled: Packet Analysis
    [Setup]    TR_SPV_WMM_Enable
    #1. Disable WMM on DUT.    2. Captuer Beacon and Probe Response packets sent by DUT.
    TR_SPV    Device.WiFi.AccessPoint.1.UAPSDEnable=1 boolean
    FUN_Parse WiFi_L2 Packets    wlan.fc.type_subtype == 0x08 and wlan.bssid == ${U_WIRELESS_2G_BSSID1} and wlan_mgt.wfa.ie.wme.qos_info.ap.u_apsd == 1    True    #Capture Beacon
    FUN_Parse WiFi_L2 Packets    wlan.fc.type_subtype == 0x05 and wlan.bssid == ${U_WIRELESS_2G_BSSID1} and wlan_mgt.wfa.ie.wme.qos_info.ap.u_apsd == 1    True    #Capture Probe Response
    #3. Go to check Expected Results.    Do GUI Check: WMM status can be shown correctly on corresponding Web GUI pages.
    Comment    GUI_Check_WMM_2G    ${U_DUT_BR0_IP}    ${U_DUT_HTTP_USER}    ${U_DUT_HTTP_PWD}    on
    #4. Reboot DUT.
    Comment    TR_Reboot_DUT and Retest
    FUN_Parse WiFi_L2 Packets    wlan.fc.type_subtype == 0x08 and wlan.bssid == ${U_WIRELESS_2G_BSSID1} and wlan_mgt.wfa.ie.wme.qos_info.ap.u_apsd == 1    True    #Capture Beacon
    FUN_Parse WiFi_L2 Packets    wlan.fc.type_subtype == 0x05 and wlan.bssid == ${U_WIRELESS_2G_BSSID1} and wlan_mgt.wfa.ie.wme.qos_info.ap.u_apsd == 1    True    #Capture Probe Response
    Comment    GUI_Check_WMM_2G    ${U_DUT_BR0_IP}    ${U_DUT_HTTP_USER}    ${U_DUT_HTTP_PWD}    on
