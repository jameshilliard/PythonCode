<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html>
<head>
  <title>add_advanced_filtering (Firewall)</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
</head>
<body class="standalone-code">
  <pre><span class="ruby-comment cmt"># File Firewall/Firewall.rb, line 3218</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_advanced_filtering</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">info</span>)
    
    <span class="ruby-comment cmt"># Now, the page must be the &quot;Add Advanced Filter&quot; page.</span>
    <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">not</span> <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">text</span>.<span class="ruby-identifier">include?</span><span class="ruby-value str">'Add Advanced Filter'</span>
      <span class="ruby-comment cmt"># Wrong here</span>
      <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:error</span>,<span class="ruby-value str">'add_advanced_filtering'</span>,<span class="ruby-value str">'Not in this page.'</span>)
      <span class="ruby-keyword kw">return</span>
    <span class="ruby-keyword kw">end</span>
    
    <span class="ruby-comment cmt"># &quot;Source Address&quot;</span>
    <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">info</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value str">'Source Address'</span>)
      
      <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">info</span>[<span class="ruby-value str">'Source Address'</span>]
      <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'Any'</span>
        <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'sym_net_obj_src'</span>).<span class="ruby-identifier">select_value</span>(<span class="ruby-value str">'ANY'</span>)
        <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:info</span>,<span class="ruby-value str">'Source Address'</span>,<span class="ruby-identifier">info</span>[<span class="ruby-value str">'Source Address'</span>])
      <span class="ruby-keyword kw">else</span>
        <span class="ruby-comment cmt"># Wrong here </span>
        <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:error</span>,<span class="ruby-value str">'add_advanced_filtering'</span>,<span class="ruby-value str">'Source address wrong.'</span>)
        <span class="ruby-keyword kw">return</span>
      <span class="ruby-keyword kw">end</span>    
      
    <span class="ruby-keyword kw">end</span>    
    
    <span class="ruby-comment cmt"># &quot;Destination Address&quot;</span>
    <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">info</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value str">'Destination Address'</span>)
      
      <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">info</span>[<span class="ruby-value str">'Destination Address'</span>]
      <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'Any'</span>
        <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'sym_net_obj_dst'</span>).<span class="ruby-identifier">select_value</span>(<span class="ruby-value str">'ANY'</span>)
        <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:info</span>,<span class="ruby-value str">'Destination Address'</span>,<span class="ruby-identifier">info</span>[<span class="ruby-value str">'Destination Address'</span>])
      <span class="ruby-keyword kw">else</span>
        <span class="ruby-comment cmt"># Wrong here </span>
        <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:error</span>,<span class="ruby-value str">'add_advanced_filtering'</span>,<span class="ruby-value str">'Destination Address wrong.'</span>)
        <span class="ruby-keyword kw">return</span>
      <span class="ruby-keyword kw">end</span>    
      
    <span class="ruby-keyword kw">end</span>  
    
    <span class="ruby-comment cmt"># &quot;Protocol&quot;</span>
    <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">info</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value str">'Protocol'</span>)
      
      <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">info</span>[<span class="ruby-value str">'Protocol'</span>]
      <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'Any'</span>
        <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'svc_service_combo'</span>).<span class="ruby-identifier">select_value</span>(<span class="ruby-value str">'ANY'</span>)
        <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:info</span>,<span class="ruby-value str">'Protocol'</span>,<span class="ruby-identifier">info</span>[<span class="ruby-value str">'Protocol'</span>])
      <span class="ruby-keyword kw">else</span>
        <span class="ruby-comment cmt"># Wrong here </span>
        <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:error</span>,<span class="ruby-value str">'add_advanced_filtering'</span>,<span class="ruby-value str">'Protocol wrong.'</span>)
        <span class="ruby-keyword kw">return</span>
      <span class="ruby-keyword kw">end</span>    
      
    <span class="ruby-keyword kw">end</span>    
    
    <span class="ruby-comment cmt"># &quot;DSCP&quot;</span>
    <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">info</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value str">'DSCP'</span>)
      
      <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">info</span>[<span class="ruby-value str">'DSCP'</span>]
      <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'on'</span>
        <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">checkbox</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'dscp_check_box'</span>).<span class="ruby-identifier">set</span>
        <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:info</span>,<span class="ruby-value str">'DSCP'</span>,<span class="ruby-identifier">info</span>[<span class="ruby-value str">'DSCP'</span>])
      <span class="ruby-keyword kw">else</span>
        <span class="ruby-comment cmt"># Wrong here </span>
        <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:error</span>,<span class="ruby-value str">'add_advanced_filtering'</span>,<span class="ruby-value str">'DSCP wrong.'</span>)
        <span class="ruby-keyword kw">return</span>
      <span class="ruby-keyword kw">end</span>    
      
    <span class="ruby-keyword kw">end</span>     
    
    <span class="ruby-comment cmt"># &quot;Priority&quot;</span>
    <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">info</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value str">'Priority'</span>)
      
      <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">checkbox</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'prio_check_box'</span>).<span class="ruby-identifier">set</span>
      
      <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">info</span>[<span class="ruby-value str">'Priority'</span>]
        
      <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'on'</span>
        <span class="ruby-comment cmt"># Do nothing here.</span>
      <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'0'</span>
        <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'prio_check_combo'</span>).<span class="ruby-identifier">select_value</span>(<span class="ruby-value str">&quot;0 (Queue 0 - Low)&quot;</span>)
      <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'1'</span>
        <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'prio_check_combo'</span>).<span class="ruby-identifier">select_value</span>(<span class="ruby-value str">&quot;1 (Queue 0 - Low)&quot;</span>)
      <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'2'</span>
        <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'prio_check_combo'</span>).<span class="ruby-identifier">select_value</span>(<span class="ruby-value str">&quot;2 (Queue 0 - Low)&quot;</span>)
      <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'3'</span>
        <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'prio_check_combo'</span>).<span class="ruby-identifier">select_value</span>(<span class="ruby-value str">&quot;3 (Queue 0 - Low)&quot;</span>)
      <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'4'</span>
        <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'prio_check_combo'</span>).<span class="ruby-identifier">select_value</span>(<span class="ruby-value str">&quot;4 (Queue 1 - Medium)&quot;</span>)
      <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'5'</span>
        <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'prio_check_combo'</span>).<span class="ruby-identifier">select_value</span>(<span class="ruby-value str">&quot;5 (Queue 1 - Medium)&quot;</span>)
      <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'6'</span>
        <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'prio_check_combo'</span>).<span class="ruby-identifier">select_value</span>(<span class="ruby-value str">&quot;6 (Queue 2 - High)&quot;</span>)
      <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'7'</span>
        <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'prio_check_combo'</span>).<span class="ruby-identifier">select_value</span>(<span class="ruby-value str">&quot;7 (Queue 2 - High)&quot;</span>)
      <span class="ruby-keyword kw">else</span>
        <span class="ruby-comment cmt"># Wrong here.</span>
        <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:error</span>,<span class="ruby-value str">'add_advanced_filtering'</span>,<span class="ruby-value str">'No such option'</span>)
        <span class="ruby-keyword kw">return</span>
      
      <span class="ruby-keyword kw">end</span> <span class="ruby-comment cmt"># end of the case</span>
      
      <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:info</span>, <span class="ruby-value str">'Priority'</span> , <span class="ruby-identifier">info</span>[<span class="ruby-value str">'Priority'</span>])
      
    <span class="ruby-keyword kw">end</span> <span class="ruby-comment cmt"># end of if  </span>
    
    <span class="ruby-comment cmt"># &quot;Length&quot;</span>
    <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">info</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value str">'Length'</span>)
      
      <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">info</span>[<span class="ruby-value str">'Length'</span>]
      <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'on'</span>
        <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">checkbox</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'length_check_box'</span>).<span class="ruby-identifier">set</span>
        <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:info</span>,<span class="ruby-value str">'Length'</span>,<span class="ruby-identifier">info</span>[<span class="ruby-value str">'Length'</span>])
      <span class="ruby-keyword kw">else</span>
        <span class="ruby-comment cmt"># Wrong here </span>
        <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:error</span>,<span class="ruby-value str">'add_advanced_filtering'</span>,<span class="ruby-value str">'Length wrong.'</span>)
        <span class="ruby-keyword kw">return</span>
      <span class="ruby-keyword kw">end</span>    
      
    <span class="ruby-keyword kw">end</span>     
    
    <span class="ruby-comment cmt"># &quot;Operation&quot;</span>
    <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">info</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value str">'Operation'</span>)    
      
      <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">info</span>[<span class="ruby-value str">'Operation'</span>]
        
      <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'Drop'</span>
        <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'rule_operation'</span>).<span class="ruby-identifier">select_value</span>(<span class="ruby-value str">&quot;0&quot;</span>)
      <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'Reject'</span>
        <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'rule_operation'</span>).<span class="ruby-identifier">select_value</span>(<span class="ruby-value str">&quot;5&quot;</span>)
      <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'Accept Connection'</span>
        <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'rule_operation'</span>).<span class="ruby-identifier">select_value</span>(<span class="ruby-value str">&quot;1&quot;</span>)
      <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'Accept Packet'</span>
        <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>, <span class="ruby-value str">'rule_operation'</span>).<span class="ruby-identifier">select_value</span>(<span class="ruby-value str">&quot;2&quot;</span>)
      <span class="ruby-keyword kw">else</span>
        <span class="ruby-comment cmt"># Wrong here.</span>
        <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:error</span>,<span class="ruby-value str">'add_advanced_filtering'</span>,<span class="ruby-value str">'No such option'</span>)
        <span class="ruby-keyword kw">return</span>
      
      <span class="ruby-keyword kw">end</span> <span class="ruby-comment cmt"># end of the case</span>
      
      <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>, <span class="ruby-identifier">:info</span>, <span class="ruby-value str">'Operation'</span>, <span class="ruby-identifier">info</span>[<span class="ruby-value str">'Operation'</span>])
      
    <span class="ruby-keyword kw">end</span> <span class="ruby-comment cmt"># end of if    </span>

    <span class="ruby-comment cmt"># &quot;Log Packets Matched by This Rule&quot;</span>
    <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">info</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value str">'Log Packets Matched by This Rule'</span>)
      
      <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">info</span>[<span class="ruby-value str">'Log Packets Matched by This Rule'</span>]
      
      <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'on'</span>
        
        <span class="ruby-comment cmt"># Set &quot;Log Packets Matched by This Rule&quot;</span>
        <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">checkbox</span>(<span class="ruby-identifier">:name</span>,<span class="ruby-value str">'rule_log'</span>).<span class="ruby-identifier">set</span>
        <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:info</span>,<span class="ruby-value str">'Log Packets Matched by This Rule'</span>,<span class="ruby-identifier">info</span>[<span class="ruby-value str">'Log Packets Matched by This Rule'</span>])
 
      <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'off'</span>
        
        <span class="ruby-comment cmt"># Clear &quot;Log Packets Matched by This Rule&quot;</span>
        <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">checkbox</span>(<span class="ruby-identifier">:name</span>,<span class="ruby-value str">'rule_log'</span>).<span class="ruby-identifier">clear</span>
        <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:info</span>,<span class="ruby-value str">'Log Packets Matched by This Rule'</span>,<span class="ruby-identifier">info</span>[<span class="ruby-value str">'Log Packets Matched by This Rule'</span>])
        
      <span class="ruby-keyword kw">else</span>
        
        <span class="ruby-comment cmt"># Wrong here</span>
        <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:error</span>,<span class="ruby-value str">'add_advanced_filtering'</span>,<span class="ruby-value str">'Did NOT find the value in \'Log Packets Matched by This Rule\'.'</span>)
        <span class="ruby-keyword kw">return</span>
        
      <span class="ruby-keyword kw">end</span> <span class="ruby-comment cmt"># end of case</span>
      
    <span class="ruby-keyword kw">end</span> <span class="ruby-comment cmt"># end of if </span>
    
    <span class="ruby-comment cmt"># &quot;When should this rule occur&quot;</span>
    <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">info</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value str">'When should this rule occur'</span>)
      
      <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">info</span>[<span class="ruby-value str">'When should this rule occur'</span>]
      
      <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'Always'</span>
        
        <span class="ruby-comment cmt"># Set &quot;Always&quot;</span>
        <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">select_list</span>(<span class="ruby-identifier">:name</span>,<span class="ruby-value str">'schdlr_rule_id'</span>).<span class="ruby-identifier">select_value</span>(<span class="ruby-value str">&quot;ALWAYS&quot;</span>)
        <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:info</span>,<span class="ruby-value str">'When should this rule occur'</span>,<span class="ruby-identifier">info</span>[<span class="ruby-value str">'When should this rule occur'</span>])
 
      <span class="ruby-keyword kw">else</span>
        
        <span class="ruby-comment cmt"># Wrong here</span>
        <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:error</span>,<span class="ruby-value str">'add_advanced_filtering'</span>,<span class="ruby-value str">'Did NOT find the value in \'When should this rule occur\'.'</span>)
        <span class="ruby-keyword kw">return</span>
        
      <span class="ruby-keyword kw">end</span> <span class="ruby-comment cmt"># end of case</span>
      
    <span class="ruby-keyword kw">end</span> <span class="ruby-comment cmt"># end of if     </span>

    <span class="ruby-comment cmt"># Apply for the change</span>
    <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">link</span>(<span class="ruby-identifier">:text</span>,<span class="ruby-value str">'Apply'</span>).<span class="ruby-identifier">click</span>
    <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">wait</span>
    
    <span class="ruby-comment cmt"># Attention?</span>
    <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">text</span>.<span class="ruby-identifier">include?</span><span class="ruby-value str">'Attention'</span>
      <span class="ruby-comment cmt"># Click the &quot;Apply&quot;</span>
      <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:warning</span>,<span class="ruby-value str">'add_advanced_filtering'</span>,<span class="ruby-value str">'Cause an \'Attention\'.'</span>)
      <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">link</span>(<span class="ruby-identifier">:text</span>,<span class="ruby-value str">'Apply'</span>).<span class="ruby-identifier">click</span>
    <span class="ruby-keyword kw">end</span>
    
    <span class="ruby-comment cmt"># Error message?</span>
    <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">text</span>.<span class="ruby-identifier">include?</span><span class="ruby-value str">'Input Errors'</span>
      <span class="ruby-comment cmt"># Error here.</span>
      
      <span class="ruby-comment cmt"># Find the table.</span>
      <span class="ruby-identifier">sTable</span> = <span class="ruby-keyword kw">false</span>
      <span class="ruby-ivar">@ff</span>.<span class="ruby-identifier">tables</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
        <span class="ruby-keyword kw">if</span> ( <span class="ruby-identifier">t</span>.<span class="ruby-identifier">text</span>.<span class="ruby-identifier">include?</span> <span class="ruby-value str">'QoS:'</span> <span class="ruby-keyword kw">and</span> 
             ( <span class="ruby-keyword kw">not</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">text</span>.<span class="ruby-identifier">include?</span> <span class="ruby-value str">'Input Errors'</span>) <span class="ruby-keyword kw">and</span>
             ( <span class="ruby-keyword kw">not</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">text</span>.<span class="ruby-identifier">include?</span> <span class="ruby-value str">'Cancel'</span>) <span class="ruby-keyword kw">and</span>
             <span class="ruby-identifier">t</span>.<span class="ruby-identifier">row_count</span> <span class="ruby-operator">==</span> <span class="ruby-value">2</span> )<span class="ruby-keyword kw">then</span>
          <span class="ruby-identifier">sTable</span> = <span class="ruby-identifier">t</span>
          <span class="ruby-keyword kw">break</span>
        <span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">end</span>
      
      <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">sTable</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">false</span>
        <span class="ruby-comment cmt"># Wrong here</span>
        <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:error</span>,<span class="ruby-value str">'add_advanced_filtering'</span>,<span class="ruby-value str">'Did NOT find the target table.'</span>)
        <span class="ruby-keyword kw">return</span>
      <span class="ruby-keyword kw">end</span>
      
      <span class="ruby-identifier">strError</span> = <span class="ruby-identifier">sTable</span>[<span class="ruby-value">1</span>][<span class="ruby-value">2</span>]
      
      <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:Result_Error</span>,<span class="ruby-value str">'add_advanced_filtering'</span>,<span class="ruby-identifier">strError</span>)
      <span class="ruby-keyword kw">return</span>
      
    <span class="ruby-keyword kw">end</span>
    
    <span class="ruby-comment cmt"># Output the result</span>
    <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">msg</span>(<span class="ruby-identifier">rule_name</span>,<span class="ruby-identifier">:info</span>,<span class="ruby-value str">'add_advanced_filtering'</span>,<span class="ruby-value str">'SUCCESS'</span>)
    
  <span class="ruby-keyword kw">end</span></pre>
</body>
</html>